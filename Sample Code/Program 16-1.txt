DAY 	DS.B 1			
MON 	DS.B 1			
DAT	  DS.B 1			
YR	  DS.B 1			
HR	  DS.B 1			
MIN	  DS.B 1			
SECS	  DS.B 1			
CNT 	  DS.B 1			
TMP 	  DS.B 1			
         ORG  ROMStart 
Entry:
  	LDS   #RAMEnd+1       
	LDAA	#$20		
  	STAA	SPI1BR    	
  	LDAA	#$54	
	STAA	SPI1CR1	
  	LDAA	#00 	
  	STAA	SPI1CR2	
  	STAA	WOMS		
  	BSET	DDRB,mDDRB_BIT7 
 	LDAA	#$0		
 	STAA	SCI0BDH 
	LDAA	#$0D		
 	STAA	SCI0BDL  	
 	LDAA	#0	   
 	STAA	SCI0CR1	
 	LDAA	#$0C	   	
 	STAA	SCI0CR2	
  	BSET	PORTB,mPORTB_BIT7
	JSR	SDELAY
	LDAA	#$8F   		
	JSR	SPI
	LDAA	#$00   		
	JSR	SPI
  	BCLR	PORTB,mPORTB_BIT7
	JSR	SDELAY
	LDAA	#$0A			
	JSR	TRANS
	LDAA	#$0D			
	JSR	TRANS
  	BSET	PORTB,mPORTB_BIT7
	LDAA	#$80   	
	JSR	SPI 		
	LDAA	#$55   	
	JSR	SPI 		
	LDAA	#$58   	
	JSR	SPI 		
	LDAA	#$16   	
	JSR	SPI 		
	LDAA	#$03     	
	JSR	SPI 		
	LDAA	#$19   	
	JSR	SPI 		
	LDAA	#$10   	
	JSR	SPI 		
	LDAA	#$07   	
	JSR	SPI 		
  	BCLR	PORTB,mPORTB_BIT7
RDA	BSET	PORTB,mPORTB_BIT7
	JSR	SDELAY
	LDAA	#$00		
	JSR	SPI 		
	JSR	SPI 		
	STAA	SECS	 	
	JSR	SPI 		
	STAA	MIN 	 	
	JSR	SPI 		
	STAA	HR 		
	JSR	SPI 		
	STAA	DAY	 	
	JSR	SPI 		
	STAA	DAT	 	
	JSR	SPI 		
	STAA	MON	 	
	JSR	SPI 		
	STAA	YR 		
  	BCLR	PORTB,mPORTB_BIT7
	LDX	#RAMStart 
	LDAA	#7		
	STAA	CNT		
B6	LDAA	0,X	 	
	ANDA	#$F0		
	LSRA			
	LSRA
	LSRA
	LSRA			
	ORAA	#$30 		
	JSR	TRANS		
	LDAA	1,X+	
	ANDA	#$0F		
	ORAA	#$30		
	JSR	TRANS		
	LDAA	#':'
	JSR	TRANS	
	DEC	CNT
	BNE	B6 		
	LDAA	#$0D		
	JSR	TRANS
	BRA	RDA	
SPI
	
	BRCLR	SPI1SR,mSPI1SR_SPTEF,SPI
	STAA	SPI1DR	
H2 	
  	BRCLR	SPI1SR,mSPI1SR_SPIF,H2 
	LDAA	SPI1DR 	
	RTS	
SDELAY
	LDAB	#$00
D1	DECB
	BNE D1
	RTS
TRANS	BRCLR	SCI0SR1,mSCI0SR1_TDRE,TRANS	
 	STAA	SCI0DRL	
	RTS			
